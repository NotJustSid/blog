<dialog class="comment-dialog">
	<div class="comment-dialog-title">Add a comment</div>
	<form class="comment-dialog-form" method="POST" action="https://gaia-comments.netlify.app/.netlify/functions/staticman">
	
		<input name="options[redirect]" type="hidden" value="https://notjustsid.github.io/blog{{ page.url }}">
  		<input name="fields[page]" type="hidden" value="{{ page.url }}">
		<input name="options[slug]" type="hidden" value="{{ page.slug }}">
		<input name="fields[reply_to]" type="hidden" id="comment-reply-to-field" value="">
	
		<input placeholder="Name" name="fields[name]" class="comment-input" required/>
		<input name="fields[email]" placeholder="Email (optional)" type="email" class="comment-input"/>
		<textarea name="fields[message]" placeholder="Add a comment" class="comment-input" rows="4" required></textarea>
	
		<button class="btn comment-form-btn" type="reset" onclick="cancelCommentDialog()">Cancel</button>
		<button type="submit" class="btn comment-form-btn">Send</button>
	</form>
	<div class="info">After submitting, your comment may take a minute or two to appear on the page.</div>
</dialog>

<script>
	function cancelCommentDialog() {
		document.querySelector('.comment-dialog').close();
	}

	function showCommentDialog() {
		document.querySelector('.comment-dialog').show();
	}

	// Check for comment status in URL and show appropriate message
	(function() {
		const params = new URLSearchParams(window.location.search);
		const status = params.get('comment');
		
		if (status === 'submitted') {
			alert('Thanks for submitting your comment! It will be reviewed and should appear on the page soon.');
			// Clean up URL
			window.history.replaceState({}, '', window.location.pathname);
		} else if (status === 'spam') {
			alert('Your comment was flagged as potential spam. If you believe this is a mistake, please reach out to me with the content of your message.');
			window.history.replaceState({}, '', window.location.pathname);
		} else if (status === 'error') {
			alert('Something went wrong while submitting your comment. Please try again later.');
			window.history.replaceState({}, '', window.location.pathname);
		}
	})();
</script>